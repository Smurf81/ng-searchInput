/*! 
 * ng-inputSearch v0.1.0
 * 
 * Copyright (c) 2014 
 * License: 
 */
angular.module("ng.inputSearch",["template/searchinput/element.html"]).directive("searchBar",[function(){var a=function(a){var b=angular.element("<div>");return a&&b.addClass(a),b},b=function(a,b){var c=a.find("ul")[0],d=c.children;return d[b]};return{restrict:"E",scope:{results:"=",searchQuery:"=",searchButton:"&",searchPartials:"&",actionOnElement:"&"},template:'<form class="form-inline"><div ng-init="warning=false" ng-show="warning && minCharSearch" class="alert alert-warning search-warning text-center"> Thank you to enter at least {{minCharSearch}} characters for your search.</div><div class="controls search"><div class="input-group col-xs-8 col-xs-offset-1 col-sm-5 col-sm-offset-3 col-md-5 col-md-offset-3 col-lg-offset-4 col-lg-4 pull-left"><input type="text" size="50" class="form-control" ng-model="searchQuery" ng-model-options="{ debounce : 300}" placeholder="Search"><div class="input-group-btn delete-button"><button type="button" class="btn btn-default" ng-click="deleteSearch($event)"><div>x</div></button></div></div><span class="center-text search-button" ng-click="searchButton()"><button type="submit" class="btn btn-primary btn-lg glyphicon glyphicon-search"></button></span><div class="dropdown" ng-class="{open:results !==undefined}"><ul class="col-xs-8 col-xs-offset-1 col-sm-5 col-sm-offset-3 col-md-5 col-md-offset-3 col-lg-offset-4 col-lg-4 dropdown-menu " role="menu"><li ng-show="results.length > 0" ng-repeat="element in results | limitTo : maxResults "><result-element element="element" ng-click="actionOnElement({id:$index})"></result-element></li><li ng-show="results.length > maxResults" class="text-center"><a ng-click="searchWithRedirect()" class="more-results">More results</a></li><li ng-show="results.length == 0" class="text-center"><span class="no-search-result">No results</span></li></ul></div></div></form>',replace:!0,link:function(c,d,e){c.maxResults=angular.isDefined(e.maxResults)?c.$parent.$eval(e.maxResults):5,c.minCharSearch=angular.isDefined(e.minCharSearch)?c.$parent.$eval(e.minCharSearch):3;c.$watch("searchQuery",function(a){a&&a.length>=c.minCharSearch?c.searchPartials():(c.results=void 0,i=0)});var f=a("dialog-backdrop");c.$watch(function(){return c.results},function(a){a&&(d.parent().append(f),f.bind("click",function(){c.$apply(function(){c.results=void 0,i=0}),f.remove()}))}),c.deleteSearch=function(a){a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1,c.searchQuery="",c.results=void 0,i=0,d.find("input")[0].focus()};var g,h,i=-1;d.on("keydown",function(a){if(27===a.keyCode&&c.$apply(function(){c.results=void 0,i=0}),40===a.keyCode&&(0==i?g=b(d,i++):i<=c.maxResults&&i<c.results.length&&(g=b(d,i),h=b(d,i-1),i++,angular.element(h).removeClass("search-focus")),angular.isDefined(g)&&angular.element(g).addClass("search-focus")),38===a.keyCode&&(0!=i&&(i--,g=b(d,i-1),h=b(d,i),angular.element(h).removeClass("search-focus")),angular.element(g).addClass("search-focus")),13===a.keyCode)if(i>0&&i<c.maxResults+1){a.preventDefault();var e=c.results[i-1];c.$apply(function(){c.actionOnElement(e.id?{id:e.id}:{id:i-1})})}else c.$apply(function(){c.searchButton()})})}}}]).directive("resultElement",[function(){return{restrict:"EA",scope:{element:"="},replace:!0,templateUrl:"template/searchinput/element.html"}}]),angular.module("template/searchinput/element.html",[]).run(["$templateCache",function(a){a.put("template/searchinput/element.html",'<div>   <span class="pull-left">{{element.name}}</span>   <span class="pull-right">{{element.value}}</span></div>')}]);